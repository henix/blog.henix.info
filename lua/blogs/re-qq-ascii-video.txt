<p>// 旧地址：<a href="http://blog.csdn.net/shell_picker/archive/2010/09/17/5889851.aspx">http://blog.csdn.net/shell_picker/archive/2010/09/17/5889851.aspx</a></p>
<p>看到最近技术宅是如此的火，比如 <a href="http://v.youku.com/v_show/id_XMTM3Mjg5OTcy=.html">Word 版 Only my railgun</a>、<a href="http://v.youku.com/v_show/id_XMTQ0MjM4Nzg4.html">Vim 版 Bad Apple</a>。我也来玩玩技术宅，装一下逼。。。</p>
<p>做出来的效果看这里（请用高清）：</p>
<p><a href="http://v.youku.com/v_show/id_XMjA2OTgzMjcy.html">http://v.youku.com/v_show/id_XMjA2OTgzMjcy.html</a></p>
<p>这个是原始视频：<a href="http://v.youku.com/v_show/id_XMjIyNjcwMA==.html">http://v.youku.com/v_show/id_XMjIyNjcwMA==.html</a> 。另外顺便一提，我这个视频跟原始视频的同步是很精确的，你可以比较一下。</p>
<p>想到要玩就玩以前的人都没有搞过的，所以我想到了用 <a href="http://www.autohotkey.com/">AutoHotKey</a> 通吃任意文本编辑器。基本原理是先把视频中的每一帧抓下来保存成图片，再使用 <a href="http://aa-project.sourceforge.net/aview">aview</a>（cygwin 里有 Windows 版）将图片转换成字符，这个直接参考了七星庐大神的攻略：<a href="http://qixinglu.com/archives/vim_is_ascii_player">http://qixinglu.com/archives/vim_is_ascii_player</a> 。</p>
<p>#{= makeImg('/files/qq-ascii-video.gif') }</p>
<p>然后一段很简单的 AutoHotKey 脚本：</p>
<pre class="brush:ahk">#b::
Loop, read, files.txt
{
    FileRead, Clipboard, %A_LoopReadLine%
    if not ErrorLevel
    {
        Send ^v
        Sleep 37
    }
}
return
</pre>
<p>每一帧图像都存到一个文件里，这些文件的名字存到 files.txt 里面。再在 AutoHotKey 中把每个文件的内容读到剪贴板里，然后每隔 37 毫秒向程序发送 Ctrl+V 。这个 37 是个经验值，是试出来的，对应于 18fps 的视频。</p>
<p>其他就是 mplayer 可以直接输出 pnm 格式的图片：</p>
<pre class="brush:bat">mplayer -vo pnm:outdir=xop18 X3-1.mp4</pre>
<p>其实 pnm -> txt 这个过程可以写个 Makefile 然后 make -j3 多线程并行转换，只不过懒得写了，直接用 <a href="http://technet.microsoft.com/zh-cn/library/cc755674%28WS.10%29.aspx">start 命令</a>实现多进程。</p>
