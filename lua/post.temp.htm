#{include: 'doctype.seg.htm' }#
<head>
#{include: 'head-common.seg.htm' }#
<link href="/css/posts.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
if (when !== 'morning') {
	document.write('<link href="/css/posts-' + when + '.css" rel="stylesheet" type="text/css" />');
}
</script>

<script type="text/javascript">
document.write('<link rel="stylesheet" href="/highlight/' + (when == 'night' ? 'rdark' : 'default') + '.css" type="text/css" />');
</script>
<noscript><link rel="stylesheet" href="/highlight/default.css" type="text/css" /></noscript>

<title>#{= title }# - 遥远的街市</title>
</head>

<body>
<div id="page">

#{include: 'header.seg.htm' }#
#{include: 'nav.seg.htm' }#
<div id="content">

<div class="blogpost">
	<div class="title"><a href="#{= getPostURL(name) }#">#{= title }#</a></div>
	<div class="post-info clearfix">
		<span class="post-time">#{= os.date('%Y年%m月%d日 %H:%M', publish_time) }#</span>
		<span class="post-cat"><a href="#{= getCategoryURL(catid) }#">#{= catname }#</a></span>
		<span class="post-stat">#{= comment_count }# 条评论</span>
	</div>
	<div class="postcontent">#{= loadFile(post_path) }#</div>
	<div class="post-tags">#{= loadFile(tags_path) }#</div>
</div>

<div class="related-posts">
	<p>相关文章：</p>
		#${
		local others = {}
		for i = 1, #blogposts do
			if blogposts[i] ~= post then
				table.insert(others, {i, calcRelative(post, blogposts[i])})
			end
		end
		local function moreRelative(a, b)
			return a[2] > b[2]
		end
		table.sort(others, moreRelative) }$#
	<ul>
			#${
			local n = 1
			while n <= #others and n <= 5 and others[n][2] > 0 do }$#
			<li><a href=""></a></li>
			#${
				n = n + 1
			end }$#
	</ul>
</div>

<div id="disqus_thread"></div>
</div><!-- content -->

#{include: 'footer.seg.htm' }#
</div><!-- page -->

<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = '#{= disqus_shortname }#'; // required: replace example with your forum shortname

	// The following are highly recommended additional parameters. Remove the slashes in front to use.
	var disqus_identifier = '#{= name }#';
	var disqus_url = '#{= siteurl }##{= getPostURL(name) }#';

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>

#{include: 'ga.seg.htm' }#
</body>
</html>
